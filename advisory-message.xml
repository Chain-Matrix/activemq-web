<div class="wiki-content maincontent"><p>ActiveMQ supports advisory messages which allows you to watch the system using regular JMS messages. Currently we have advisory messages that support:</p><ul><li>consumers, producers and connections starting and stopping</li><li>temporary destinations being created and destroyed</li><li>messages expiring on topics and queues</li><li>brokers sending messages to destinations with no consumers.</li><li>connections starting and stopping</li></ul><p>Advisory messages can be thought as some kind of administrative channel where you receive information regarding what is happening on your JMS provider along with what's happening with producers, consumers and destinations. When you look at a broker via <a shape="rect" href="jmx.xml">JMX</a> you will see the advisory topics prefixed with <strong><code>ActiveMQ.Advisory.</code></strong>.</p><p>Every Advisory has the message <strong>type</strong> 'Advisory' and some predefined message properties:</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Property</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Type</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Description</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Version</p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>originBrokerId</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>StringProperty</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>The id of the broker where the advisory originated.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>5.x</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>originBrokerName</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>StringProperty</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>The name of the broker where the advisory originated.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>5.x</p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>originBrokerURL</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>StringProperty</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>The first URL of the broker where the advisory originated.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>5.2</p></td></tr></tbody></table></div><p>In addition, some messages carry a&#160;<strong><code>Command</code></strong> object, which carries additional information about the nature of the advisory, e.g., a subscription to each of the destination returns an <strong><code>ActiveMQMessage</code></strong>. Specific&#160;<strong><code>DataStructure</code></strong> objects, e.g.,. <strong><code>ConsumerInfo</code>, <code>ProducerInfo</code></strong>, <strong><code>ConnectionInfo</code></strong> can be retrieved using <strong><code>ActiveMQMessage.getDataStructure()</code></strong>.</p><p>For example:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[Destination advisoryDestination = AdvisorySupport.getProducerAdvisoryTopic(destination)
MessageConsumer consumer = session.createConsumer(advisoryDestination);
consumer.setMessageListener(this);

public void onMessage(Message msg){
    if(msg instanceof ActiveMQMessage) {
        try {
             ActiveMQMessage aMsg = (ActiveMQMessage)msg;
             ProducerInfo prod = (ProducerInfo) aMsg.getDataStructure();
        } 
        catch(JMSException e) {
            log.error(&quot;Failed to process message: &quot; + msg);
        }
    }
}
]]></script>
</div></div><h2 id="AdvisoryMessage-Thefollowingadvisorytopicsaresupported">The following advisory topics are supported</h2><h3 id="AdvisoryMessage-Clientbasedadvisories">Client based advisories</h3><div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Tip</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>These are always generated.</p></div></div><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Advisory Topics</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Description</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Properties</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Data Structure</p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.Connection</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Connection start &amp; stop messages.</p></td><td colspan="1" rowspan="1" class="confluenceTd">&#160;</td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ConnectionInfo</code>,&#160;<code>RemoveInfo</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.Producer.Queue</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Producer start &amp; stop messages on a Queue.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='producerCount'</code> - the number of producers</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ProducerInfo</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.Producer.Topic</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Producer start &amp; stop messages on a Topic.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='producerCount'</code>&#160;- the number of producers</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ProducerInfo</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.Consumer.Queue</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Consumer start &amp; stop messages on a Queue.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='consumerCount'</code> - the number of Consumers</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ConnectionInfo</code>,&#160;<code>RemoveInfo</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.Consumer.Topic</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Consumer start &amp; stop messages on a Topic.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='consumerCount'</code>&#160;- the number of Consumers</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ConnectionInfo</code>,&#160;<code>RemoveInfo</code></p></td></tr></tbody></table></div><p>Note that the consumer start/stop advisory messages also have a&#160;<strong><code>consumerCount</code></strong> header to indicate the number of active consumers on the destination when the advisory message was sent. This means you can use the following selector to be notified when there are no active consumers on a given destination:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[consumerCount = 0
]]></script>
</div></div><h3 id="AdvisoryMessage-DestinationandMessagebasedadvisories">Destination and Message based advisories</h3><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Advisory Topics</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Description</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Properties</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Data Structure</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Default</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>PolicyEntry Property</p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.Queue</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Queue create &amp; destroy.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>null</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>DestinationInfo</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>true</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>none</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.Topic</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Topic create &amp; destroy.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>null</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>DestinationInfo</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>true</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>none</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.TempQueue</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Temporary Queue create &amp; destroy.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>null</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>DestinationInfo</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>true</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>none</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.TempTopic</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Temporary Topic create &amp; destroy.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>null</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>DestinationInfo</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>true</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>none</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.Expired.Queue</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Expired messages on a Queue.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='orignalMessageId'</code> - the expired id</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>Message</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>true</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>none</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.Expired.Topic</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Expired messages on a Topic.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='orignalMessageId'</code> - the expired id</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>Message</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>true</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>none</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.NoConsumer.Queue</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>No consumer is available to process messages being sent on a Queue.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>null</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>Message</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>false</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>sendAdvisoryIfNoConsumers</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.NoConsumer.Topic</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>No consumer is available to process messages being sent on a Topic.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>null</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>Message</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>false</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>sendAdvisoryIfNoConsumers</code></p></td></tr></tbody></table></div><div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Tip</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p><strong><code>NoConsumer</code></strong> topic advisories are sent only for non-persistent messages.</p></div></div><h3 id="AdvisoryMessage-Newadvisoriesinversion5.2">New advisories in version 5.2</h3><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Advisory Topics</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Description</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Properties</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Data Structure</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Default</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>PolicyEntry Property</p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.SlowConsumer.Queue</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Slow Queue Consumer.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='consumerId'</code> - the consumer id</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ConsumerInfo</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>false</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>advisoryForSlowConsumers</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.SlowConsumer.Topic</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Slow Topic Consumer.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='consumerId'</code>&#160;- the consumer id</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ConsumerInfo</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>false</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>advisoryForSlowConsumers</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.FastProducer.Queue</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Fast Queue producer.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='producerId'</code> - the producer id</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ProducerInfo</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>false</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>advisdoryForFastProducers</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory. FastProducer.Topic</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Fast Topic producer.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='consumerId'</code>' - the producer id</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ProducerInfo</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>false</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>advisdoryForFastProducers</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.MessageDiscarded.Queue</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Message discarded.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='orignalMessageId'</code> - the discarded id</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>Message</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>false</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>advisoryForDiscardingMessages</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.MessageDiscarded.Topic</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Message discarded.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='orignalMessageId'</code>&#160;- the discarded id</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>Message</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>false</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>advisoryForDiscardingMessages</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.MessageDelivered.Queue</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Message delivered to the broker.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='orignalMessageId'</code>&#160;- the delivered id</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>Message</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>false</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>advisoryForDelivery</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.MessageDelivered.Topic</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Message delivered to the broker.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='orignalMessageId'</code>&#160;- the delivered id</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>Message</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>false</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>advisoryForDelivery</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.MessageConsumed.Queue</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Message consumed by a client.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='orignalMessageId'</code>&#160;- the delivered id</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>Message</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>false</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>advisoryForConsumed</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.MessageConsumed.Topic</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Message consumed by a client.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='orignalMessageId'</code>&#160;- the delivered id</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>Message</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>false</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>advisoryForConsumed</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.FULL</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>A Usage resource is at its limit.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='usageName'</code> - the name of Usage resource</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>null</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>false</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>advisoryWhenFull</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.MasterBroker</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>A broker is now the master in a master/slave configuration.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>null</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>null</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>true</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>none</code></p></td></tr></tbody></table></div><h3 id="AdvisoryMessage-NewAdvisoriesin5.4">New Advisories in 5.4</h3><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Advisory Topics</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Description</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Properties</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Data Structure</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Default</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>PolicyEntry Property</p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.MessageDLQd.Queue</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Message sent to DLQ.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='orignalMessageId'</code> - the delivered id</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>Message</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Always on</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>advisoryForConsumed</code></p></td></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.MessageDLQd.Topic</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Message sent to DLQ.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>String='orignalMessageId'</code>&#160;- the delivered id</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>Message</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Always on</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>advisoryForConsumed</code></p></td></tr></tbody></table></div><h3 id="AdvisoryMessage-Networkbridgeadvisories">Network bridge advisories</h3><p>Starting with ActiveMQ version 5.5 you can watch advisory topics for events related to the status of network bridges. You can get advisory messages when the network bridge is started or stopped.</p><div class="table-wrap"><table class="confluenceTable"><tbody><tr><th colspan="1" rowspan="1" class="confluenceTh"><p>Advisory Topics</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Description</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Properties</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Data Structure</p></th><th colspan="1" rowspan="1" class="confluenceTh"><p>Default</p></th></tr><tr><td colspan="1" rowspan="1" class="confluenceTd"><p><code>ActiveMQ.Advisory.NetworkBridge</code></p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Network bridge being stopped or started.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>Boolean="started"</code>&#160;-&#160;<strong><code>true</code></strong> if bridge is started,&#160;<strong><code>false</code></strong> if it is stopped.<br clear="none"><code>Boolean="createdByDuplex"</code>&#160;-&#160;<strong><code>true</code></strong> if the bridge is created by remote network connector.</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p><code>BrokerInfo</code> - provides data of the remote broker</p></td><td colspan="1" rowspan="1" class="confluenceTd"><p>Always on</p></td></tr></tbody></table></div><h3 id="AdvisoryMessage-EnablingAdvisoriesDisabledbyDefault">Enabling Advisories Disabled by Default</h3><p>The advisories that are not turned on by default (see the last column) can be enabled on a&#160;<strong><code>PolicyEntry</code></strong> in the ActiveMQ Broker Configuration, e.g., to enable a message consumed advisory you can configure the following:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<script class="brush: xml; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[&lt;destinationPolicy&gt;
    &lt;policyMap&gt;
       &lt;policyEntries&gt; 
           &lt;policyEntry topic=&quot;&gt;&quot; advisoryForConsumed=&quot;true&quot;/&gt;
       &lt;/policyEntries&gt;
    &lt;/policyMap&gt;
&lt;/destinationPolicy&gt;
]]></script>
</div></div><div class="confluence-information-macro confluence-information-macro-information"><p class="title">Hint</p><span class="aui-icon aui-icon-small aui-iconfont-info confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>The&#160;<strong><code>&gt;</code></strong> character matches all topics - you can use wild-card matches for setting a destination policy - see <a shape="rect" href="wildcards.xml">Wildcards</a></p></div></div><h3 id="AdvisoryMessage-DisablingAdvisoryMessages">Disabling Advisory Messages</h3><p>The use of advisory messages incurs a small overhead in terms of memory and connection resources that is related to the number of destinations in your system. In some cases it can make sense to disable all advisories.</p><p>Advisories need to be disabled both on the Broker, via XML Configuration</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[&lt;broker advisorySupport=&quot;false&quot;&gt;
]]></script>
</div></div><p>or from java code:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[BrokerService broker = new BrokerService();
broker.setAdvisorySupport(false);
// ...
broker.start();
]]></script>
</div></div><p><em>and</em> on your&#160;<strong><code>ActiveMQConnectionFactory</code></strong> (because a subscription to an advisory topic will auto create it) via the <strong><code>brokerUrl</code></strong>:</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[tcp://localhost:61616?jms.watchTopicAdvisories=false
]]></script>
</div></div><p>or via java code using the&#160;<strong><code>watchTopicAdvisories</code></strong> attribute on the <strong><code>ActiveMQConnectionFactory</code></strong>.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[ActiveMQConnectionFactory factory = new ActiveMQConnectionFactory();
factory.setWatchTopicAdvisories(false);
]]></script>
</div></div><div class="confluence-information-macro confluence-information-macro-warning"><p class="title">Warning</p><span class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>Advisory messages are required for <a shape="rect" href="networks-of-brokers.xml">dynamic network broker topologies</a> as&#160;<code>NetworkConnectors</code> subscribe to advisory messages. In the absence of advisories, a network must be statically configured.</p></div></div><h3 id="AdvisoryMessage-UsingtheDestinations">Using the Destinations</h3><p>All of the above destinations are really prefixes which are appended with important information (like the actual topic or queue, the client ID, producer ID, consumer ID etc). This allows you to reuse the power of publish/subscribe, <a shape="rect" href="wildcards.xml">Wildcards</a> and <a shape="rect" href="selectors.xml">Selectors</a> to filter the advisory messages as you see fit.</p><p>For example if you want to subscribe to expired messages on a topic&#160;<strong><code>FOO.BAR</code></strong> you could subscribe to <strong><code>ActiveMQ.Advisory.Expired.Topic.FOO.BAR</code></strong>. To subscribe to all messages of a certain kind of advisory just append <strong><code>.&gt;</code></strong> to the topic, e.g., to subscribe to all the consumers starting and stopping to topics and queues subscribe to <strong><code>ActiveMQ.Advisory.Consumer..&gt;</code></strong>.</p><h3 id="AdvisoryMessage-HelperMethods">Helper Methods</h3><p>Methods to get the advisory destination objects are available in <a shape="rect" class="external-link" href="http://incubator.apache.org/activemq/maven/activemq-core/apidocs/org/apache/activemq/advisory/AdvisorySupport.html">AdvisorySupport</a> through the following methods.</p><div class="code panel pdl" style="border-width: 1px;"><div class="codeContent panelContent pdl">
<script class="brush: java; gutter: false; theme: Default" type="syntaxhighlighter"><![CDATA[AdvisorySupport.getConsumerAdvisoryTopic()
AdvisorySupport.getProducerAdvisoryTopic()
AdvisorySupport.getExpiredTopicMessageAdvisoryTopic()
AdvisorySupport.getExpiredQueueMessageAdvisoryTopic()
AdvisorySupport.getNoTopicConsumersAdvisoryTopic()
AdvisorySupport.getNoQueueConsumersAdvisoryTopic()
AdvisorySupport.getDestinationAdvisoryTopic()
AdvisorySupport.getExpiredQueueMessageAdvisoryTopic()
AdvisorySupport.getExpiredTopicMessageAdvisoryTopic()
AdvisorySupport.getNoQueueConsumersAdvisoryTopic()
AdvisorySupport.getNoTopicConsumersAdvisoryTopic()

// Version 5.2 on:

AdvisorySupport.getSlowConsumerAdvisoryTopic()
AdvisorySupport.getFastProducerAdvisoryTopic()
AdvisorySupport.getMessageDiscardedAdvisoryTopic()
AdvisorySupport.getMessageDeliveredAdvisoryTopic()
AdvisorySupport.getMessageConsumedAdvisoryTopic()
AdvisorySupport.getMasterBrokerAdvisoryTopic()
AdvisorySupport.getFullAdvisoryTopic()
]]></script>
</div></div><p>Some helper classes to deal with advisory messages are available in the <a shape="rect" class="external-link" href="http://activemq.apache.org/maven/activemq-core/apidocs/org/apache/activemq/advisory/package-summary.html">advisories</a> package.</p></div>

