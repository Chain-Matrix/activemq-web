<div class="wiki-content maincontent"><h2 id="Building-BuildingNMS">Building NMS</h2><p>Currently our main build tool for NMS is <a shape="rect" class="external-link" href="http://nant.sourceforge.net/" rel="nofollow">NAnt</a>.</p><div class="confluence-information-macro confluence-information-macro-tip"><p class="title">Setup For *NIX Users</p><span class="aui-icon aui-icon-small aui-iconfont-approve confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><ul><li>Install <a shape="rect" class="external-link" href="http://www.mono-project.com" rel="nofollow">Mono</a></li><li><p>On some operating systems (e.g. OS X), you may need to point the <strong>PKG_CONFIG_PATH</strong> environment variable at the mono packages</p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>export PKG_CONFIG_PATH="/Library/Frameworks/Mono.framework/Versions/Current/lib/pkgconfig/:${PKG_CONFIG_PATH}"
</pre>
</div></div></li><li>Depending on your installation of <a shape="rect" class="external-link" href="http://www.mono-project.com" rel="nofollow">Mono</a>, you may need additional steps to get NAnt going on OS X. The more recent versions of the Mono installer for OS X seem to set things up properly. However, if you are having problems running NAnt, try the following:<ul><li>download the binary of <a shape="rect" class="external-link" href="http://nant.sourceforge.net/" rel="nofollow">NAnt</a></li><li>create a script file called nant</li><li>chmod a+x nant</li><li><p>put the following into the script...</p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>#!/bin/sh
exec /usr/bin/mono /path/to/nant/NAnt.exe "$@"
</pre>
</div></div></li></ul></li></ul><p>Thanks to the hints from <a shape="rect" class="external-link" href="http://cs-sdl.sourceforge.net/index.php/The_absolute_newbies_guide_to_SDL.NET" rel="nofollow">this page</a>.</p></div></div><h3 id="Building-BuildingNMSwithNant">Building NMS with Nant</h3><p>There are two steps to build the NMS project code, we'll look at each now.</p><h4 id="Building-SettingupyourNAntRepository.">Setting up your NAnt Repository.</h4><p>Before you can build the NMS API and the various provider libraries you need to initialize your local NAnt repository so that you have all the required dependencies available for the provider's NAnt build scripts to pull in during their builds. We maintain a tree in the NMS SVN repo with all the required dependencies which allow you to easily populate you NAnt repo. You can check out this tree by executing the following:</p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>svn co https://svn.apache.org/repos/asf/activemq/activemq-dotnet/vendor/ 
</pre>
</div></div><p>Now that you have the vendor tree checkout out you can install the various libaries into you NAnt repo by running each one's build script and with the 'install' target. You will need nant-0.91 or higher. The version 0.90 won't work. Let's take the NUnit testing framework libraries as an example, you install them like so:</p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>cd ./activemq-dotnet/vendor/NUnit/2.5.8
nant install
</pre>
</div></div><p>Install each of the vendor libraries using the same process and then you are ready to build the NMS libraries.</p><h4 id="Building-BuildingtheNMSAPIandProviderlibraries.">Building the NMS API and Provider libraries.</h4><p>To build the code with Nant you will need to build the individual modules, starting with the main NMS module first. Following are the steps needed to build all of the modules, but depending on which provider you are using, you may only need to build the main Apache.NMS module and then your specific provider module. For example, if you are only working with ActiveMQ, then you would need to build the Apache.NMS module and the Apache.NMS.ActiveMQ provider module. Here are the steps to build all of the modules for the trunk version. Modify the paths to build a particular tag release (e.g., change the <strong>trunk</strong> folder to <strong>tags\1.0.0</strong>):</p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>cd activemq-dotnetcd Apache.NMS\trunk
nant

cd ..\..\Apache.NMS.ActiveMQ\trunk
nant

cd ..\..\Apache.NMS.AMQP\trunk
nant

cd ..\..\Apache.NMS.EMS\trunk
nant

cd ..\..\Apache.NMS.MQTT\trunk
nant

cd ..\..\Apache.NMS.MSMQ\trunk
nant

cd ..\..\Apache.NMS.Stomp\trunk
nant

cd ..\..\Apache.NMS.WCF\trunk
nant

cd ..\..\Apache.NMS.ZMQ\trunk
nant </pre>
</div></div><p>This will build all of the providers. The only module that needs to be built first is the Apache.NMS module, as all of the other provider modules depend upon that module. <strong>IMPORTANT:</strong> In order to build the Apache.NMS.EMS module, you must have a licensed copy of the TIBCO.EMS.dll. This module is not available from The Apache Software Foundation.</p><div class="confluence-information-macro confluence-information-macro-warning"><p class="title">Running the Unit Tests</p><span class="aui-icon aui-icon-small aui-iconfont-error confluence-information-macro-icon"></span><div class="confluence-information-macro-body"><p>The unit tests depend on an ActiveMQ broker running on tcp://localhost:61616 so that the test cases can connect to ActiveMQ and send and receive messages etc. So if you have a distribution of ActiveMQ, <a shape="rect" class="external-link" href="http://activemq.apache.org/getting-started.html#GettingStarted-StartingActiveMQ">run the broker</a> first before testing Apache.NMS.ActiveMQ.</p></div></div><p>If you want to run a build with the unit tests (assuming you have a broker running) then type the following from the <strong>trunk</strong> folder of the provider module:</p><div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent panelContent">
<pre>nant test
</pre>
</div></div><p>Alternatively, you can use the NUnit graphical interface to load the appropriate module's nunit project file. Each project includes a file named Apache.NMS.<em>modulename</em>.Test.nunit, where <em>modulename</em> matches the provider module's name (e.g., ActiveMQ, AMQP, EMS, MQTT, MSMQ, Stomp, WCF, or ZMQ). This file can be loaded into the NUnit's graphical application to run all of the unit tests and see their output.</p><h2 id="Building-IDETips">IDE Tips</h2><p>If you are on windows then you probably want to use Visual Studio 2008; we highly recommend using <a shape="rect" class="external-link" href="http://www.jetbrains.com/resharper/" rel="nofollow">ReSharper</a> as well, - its a shame there is not a distro for OS X and Linux <img class="emoticon emoticon-sad" src="https://cwiki.apache.org/confluence/s/en_GB/5997/6f42626d00e36f53fe51440403446ca61552e2a2.1/_/images/icons/emoticons/sad.png" data-emoticon-name="sad" alt="(sad)">.</p><h3 id="Building-UsingMonoDeveloptoeditC#">Using <a shape="rect" class="external-link" href="http://monodevelop.com/" rel="nofollow">MonoDevelop</a> to edit C#</h3><p>If you are on OS X or Linux (and even Windows nowdays) we recommend the use of <a shape="rect" class="external-link" href="http://monodevelop.com" rel="nofollow">MonoDevelop</a> for editing, refactoring and running the code. MonoDevelop can load the NMS Visual Studio Project files, and is integrated with the Mono debugger as well.</p><h3 id="Building-UsingEclipsetoeditC#">Using Eclipse to edit C#</h3><p>You can use Eclipse as your IDE to edit C# code.</p><p>If you want to use Eclipse there are the following two C# eclipse plugins we are aware of</p><ul><li><a shape="rect" class="external-link" href="http://emonic.sourceforge.net/" rel="nofollow">Emonic</a></li><li><a shape="rect" class="external-link" href="http://black-sun.sourceforge.net/" rel="nofollow">BlackSun</a></li><li><a shape="rect" class="external-link" href="http://www.improve-technologies.com/alpha/esharp/" rel="nofollow">Improve C#</a></li></ul><p>We tend to use BlackSun as it has auto-format and outline view support along with compiler warnings (though you might want to change the default font size).</p></div>

